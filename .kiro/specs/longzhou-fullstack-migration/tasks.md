# 龙舟投票系统全栈迁移 - 实施任务计划

## 任务概述

将现有的纯前端龙舟投票系统迁移到完整的前后端分离架构，实现数据持久化、用户认证、防刷票功能和统计分析。

## 实施任务列表

- [x] 1. 数据库环境搭建和表结构创建




  - 执行数据库迁移脚本，创建 4 张核心表（投票记录、活动配置、作品信息、浏览记录）
  - 创建视图和存储过程，实现防刷票业务逻辑
  - 导入初始数据（8 个示例作品和默认活动配置）
  - 验证表结构、索引、外键约束的正确性
  - _需求: 1.1, 1.2, 1.3_



- [x] 2. 后端用户认证 API 开发



  - 基于 RuoYi 框架实现用户登录接口
  - 实现 JWT Token 生成和验证机制
  - 创建用户信息获取接口
  - 实现登录状态检查和权限验证
  - 编写用户认证相关的单元测试
  - _需求: 2.1, 2.2, 2.3, 2.4, 2.5_
-

- [x] 3. 后端作品管理 API 开发







  - 实现作品列表查询接口（支持分页，游客可访问）
  - 实现作品详情查询接口（游客可访问）
  - 实现排行榜查询接口（实时排序，游客可访问）
  - 实现浏览记录 API（记录用户浏览行为）
  - 编写作品相关 API 的单元测试
  - _需求: 3.1, 3.6_

- [x] 4. 后端投票核心 API 开发



  - 实现投票接口，集成防刷票存储过程（需要登录）
  - 实现取消投票接口（需要登录）
  - 实现用户投票状态查询接口（需要登录）
  - 实现用户投票记录查询接口（需要登录）
  - 编写投票相关 API 的单元测试，验证防刷票机制
  - _需求: 3.2, 3.4, 3.5_

- [x] 5. 后端活动配置 API 开发

  - 实现活动配置查询接口（游客可访问）
  - 实现活动规则查询接口（游客可访问）
  - 实现活动配置更新接口（管理员权限）
  - 编写配置相关 API 的单元测试
  - _需求: 5.1, 5.2, 5.3, 5.4_

- [ ] 6. 前端登录页面开发

  - 创建 LoginPage.vue 组件，使用 Element Plus UI
  - 实现登录表单验证和提交逻辑
  - 集成用户认证 API 调用
  - 实现登录成功后的页面跳转
  - 实现登录错误处理和用户提示
  - _需求: 2.1, 2.2, 2.3_

- [ ] 7. 前端用户状态管理开发

  - 创建 useUserStore，管理登录状态和用户信息
  - 实现 JWT Token 的本地存储和自动恢复
  - 实现登录状态的全局检查和更新
  - 实现用户退出登录功能
  - 编写用户状态管理的单元测试
  - _需求: 2.4, 2.5_

- [ ] 8. 前端路由守卫开发

  - 实现路由守卫，检查页面访问权限
  - 配置需要登录的页面路由（投票页面）
  - 实现未登录用户自动跳转到登录页
  - 实现登录后自动跳转到目标页面
  - 测试路由守卫的各种场景
  - _需求: 2.1, 4.3_

- [ ] 9. 前端投票页面 API 适配

  - 修改投票页面，从 API 加载作品数据而不是 localStorage
  - 实现投票按钮的 API 调用和状态更新
  - 实现投票限制的前端显示（今日已投票 X/3 次）
  - 实现投票成功/失败的用户提示
  - 实现未登录用户点击投票时跳转到登录页
  - _需求: 4.1, 4.2, 4.3, 4.6_

- [ ] 10. 前端排行榜页面 API 适配

  - 修改排行榜页面，从 API 获取实时排行数据
  - 实现排行榜的自动刷新机制
  - 保持现有的 UI 设计和用户体验
  - 实现 API 调用失败时的错误处理
  - 测试排行榜数据的准确性
  - _需求: 4.1, 4.6_

- [ ] 11. 前端详情页面 API 适配和浏览记录

  - 修改详情页面，从 API 获取作品详情数据
  - 实现浏览记录 API 调用（页面访问时自动记录）
  - 实现浏览数的实时更新显示
  - 保持现有的详情页面 UI 和交互
  - 实现 API 调用失败时的降级处理
  - _需求: 4.4, 4.5, 4.6_

- [ ] 12. 前端规则页面动态配置适配

  - 修改规则页面，从 API 获取活动配置和规则信息
  - 实现规则图片的动态加载
  - 实现活动规则文本的动态显示
  - 实现活动时间和投票限制的动态显示
  - 测试配置更新后前端的自动刷新
  - _需求: 5.1, 5.2_

- [ ] 13. 系统集成测试和防刷票验证

  - 测试完整的用户注册、登录、投票流程
  - 验证每日投票限制（3 次）的正确执行
  - 验证重复投票限制的正确执行
  - 测试多用户并发投票的数据一致性
  - 验证浏览记录和统计数据的准确性
  - _需求: 3.2, 3.4, 3.5_

- [ ] 14. 错误处理和用户体验优化

  - 实现全局错误处理机制
  - 优化 API 调用的加载状态显示
  - 实现网络异常时的友好提示
  - 优化投票按钮的交互反馈
  - 实现数据加载失败时的重试机制
  - _需求: 4.6_

- [ ] 15. 性能优化和缓存实现

  - 实现作品列表和排行榜的前端缓存
  - 优化 API 调用频率，减少不必要的请求
  - 实现图片懒加载和 CDN 优化
  - 优化数据库查询性能
  - 进行系统性能测试和调优
  - _性能要求: 响应时间、并发处理_

- [ ] 16. 部署配置和环境验证
  - 配置生产环境的数据库连接
  - 部署后端 API 服务到生产环境
  - 部署前端应用到生产环境
  - 验证生产环境的完整功能
  - 进行生产环境的性能和安全测试
  - _部署和维护要求_
